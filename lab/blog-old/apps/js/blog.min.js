/*! blog-1.0.0.js 2015-07-02 */
(function(){"use strict";angular.module("cageblog",["ngRoute","ngCookies","firebase","ng.ueditor"]).run(["$rootScope","$location","$cookies",function(a,b,c){return a.$on("$routeChangeStart",function(a,d){return d.authorized&&!c.uid?b.path("#"):void 0})}]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"apps/views/articles.html",controller:"ArticleCtrl"}).when("/login",{templateUrl:"apps/views/login.html",controller:"AccountCtrl"}).when("/article/:id",{templateUrl:"apps/views/article.html",controller:"ArticleCtrl"}).when("/manage/:id",{templateUrl:"apps/views/manage.html",controller:"ManageCtrl",authorized:!0}).when("/manage",{templateUrl:"apps/views/manage.html",controller:"ManageCtrl",authorized:!0}).when("/about",{templateUrl:"apps/views/about.html"}).otherwise({redirectTo:"/"})}])}).call(this),function(){angular.module("cageblog").controller("AccountCtrl",["$scope","account","$location",function(a,b,c){a.auth=b.authorized(),a.login=function(){a.isLoading=!0,b.signIn(a.email,a.password,function(){a.email="",a.password="",a.isLoading=!1,a.isLogin=!1,a.auth=b.authorized()})}}]).controller("ArticleCtrl",["$scope","article","account","$routeParams",function(a,b,c,d){var e,f;f=b.get(),e=d.id,a.articles=f,a.auth=c.authorized(),e&&f.$loaded().then(function(){a.article=f.$getRecord(e)})}]).controller("ManageCtrl",["$scope","article","account","$location","$routeParams",function(a,b,c,d,e){var f,g;g=b.get(),f=e.id,a.article={},a.articles=g,a.current=c.getCurrent(),a._simpleConfig={autoClearinitialContent:!1,wordCount:!0,elementPathEnabled:!1},f&&g.$loaded().then(function(){a.article=g.$getRecord(f)}),a.add=function(){a.article.$id?b.save(a.article,function(){a.article=void 0}):b.add({title:a.article.title,author:a.current.nickName,category:a.article.category,description:a.article.description,time:(new Date).getTime(),pinned:a.article.pinned===!0},function(){a.article=void 0})},a.edit=function(b){a.article=b},a.remove=function(a){b.remove(a)},a.signOut=function(){c.signOut(),d.path("#")}}])}.call(this),function(){angular.module("cageblog").directive("cageCategory",[function(){var a,b;return b=function(){return Math.floor(9*Math.random())},a=function(a,c,d){a.$watch(d.cageCategory,function(a){var d,e,f,g,h;if(a)for(h=a.split(","),f=0,g=h.length;g>f;f++)e=h[f],d=angular.element('<a class="post-category" href="javascript:void(0)"></a>'),d.addClass("post-category-"+b()),d.text(e),c.append(d)})},{link:a}}])}.call(this),function(){angular.module("cageblog").filter("unsafe",["$sce",function(a){return function(b){return void 0===b?"":a.trustAsHtml(b)}}]).filter("summary",[function(){var a;return a=function(a){var b,c,d;return d=/(<[^>]+>)*/gim,b=/<\/?\w+>$/,c=/(&nbsp;)*/,a.replace(d,"").replace(b).replace(c,"")},function(b){return void 0===b?"":a(b)}}])}.call(this),function(){angular.module("cageblog").factory("db",[function(){var a;return a=new Firebase("bitcage.firebaseio.com"),{getDB:function(){return a}}}]).factory("account",["$cookies","db","$firebaseAuth","$firebaseObject",function(a,b,c,d){var e;return b=b.getDB(),e=c(b),{authorized:function(){return void 0!==a.uid},getCurrent:function(){return this.authorized()?d(b.child("users/"+a.uid)):void 0},signIn:function(b,c,d){e.$authWithPassword({email:b,password:c}).then(function(b){a.uid=b.uid,d&&d()})["catch"](function(a){alert(a)})},signOut:function(){delete a.uid,e.$unauth()}}}]).factory("article",["db","$firebaseArray",function(a,b){var c;return a=a.getDB(),c=b(a.child("articles")),{get:function(){return c},add:function(a,b){c.$add(a).then(function(a){b&&b()})["catch"](function(a){alert(a)})},save:function(a,b){c.$save(a).then(function(a){b&&b()})["catch"](function(a){alert(a)})},remove:function(a,b){c.$remove(a).then(function(a){b&&b()})["catch"](function(a){alert(a)})}}}])}.call(this);